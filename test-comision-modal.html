<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test: Propuestas Modal Comisión</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .version-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .version-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }
        
        .badge-version {
            font-size: 0.8rem;
            padding: 5px 15px;
        }
        
        /* Estilos para la timeline */
        .timeline-container {
            position: relative;
            height: 80px;
            margin: 20px 0;
        }
        
        .timeline-line {
            position: absolute;
            top: 40px;
            left: 40px;
            right: 40px;
            height: 4px;
            background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #dc3545 100%);
            border-radius: 2px;
        }
        
        .timeline-marker {
            position: absolute;
            top: 20px;
            text-align: center;
            transform: translateX(-50%);
        }
        
        .timeline-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        /* Animación del nombre preview */
        .name-preview {
            transition: all 0.3s ease;
        }
        
        .name-preview.updated {
            animation: pulse 0.5s;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Cards con gradientes */
        .gradient-card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .gradient-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        
        .gradient-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="text-center mb-4">
            <h1 class="text-white display-4 mb-3">
                <i class="bi bi-palette-fill me-3"></i>
                Test de Propuestas: Modal de Comisión
            </h1>
            <p class="text-white lead">Explora las diferentes mejoras visuales</p>
        </div>

        <!-- VERSIÓN ACTUAL -->
        <div class="version-card">
            <div class="version-title">
                <span class="badge badge-version bg-secondary">ACTUAL</span>
                Versión Original - Modal Básico
            </div>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-original">
                <i class="bi bi-eye me-2"></i>Ver Modal Original
            </button>
        </div>

        <!-- PROPUESTA 1: Header con Vista Previa -->
        <div class="version-card">
            <div class="version-title">
                <span class="badge badge-version bg-success">PROPUESTA 1</span>
                Header con Vista Previa + Duración
            </div>
            <div class="alert alert-info">
                <i class="bi bi-lightbulb-fill me-2"></i>
                <strong>Mejoras:</strong> Preview del nombre en tiempo real, badge de duración calculada
            </div>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modal-propuesta1">
                <i class="bi bi-eye me-2"></i>Ver Propuesta 1
            </button>
        </div>

        <!-- PROPUESTA 2: Layout 2 Columnas -->
        <div class="version-card">
            <div class="version-title">
                <span class="badge badge-version bg-primary">PROPUESTA 2</span>
                Layout en 2 Columnas con Cards
            </div>
            <div class="alert alert-info">
                <i class="bi bi-lightbulb-fill me-2"></i>
                <strong>Mejoras:</strong> Organización visual mejorada, separación por contexto (Persona | Comisión+POC)
            </div>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-propuesta2">
                <i class="bi bi-eye me-2"></i>Ver Propuesta 2
            </button>
        </div>

        <!-- PROPUESTA 3: Validación RUT Visual -->
        <div class="version-card">
            <div class="version-title">
                <span class="badge badge-version bg-warning text-dark">PROPUESTA 3</span>
                Validación de RUT con Feedback Visual
            </div>
            <div class="alert alert-info">
                <i class="bi bi-lightbulb-fill me-2"></i>
                <strong>Mejoras:</strong> Formateo automático, validación en tiempo real, iconos de estado
            </div>
            <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#modal-propuesta3">
                <i class="bi bi-eye me-2"></i>Ver Propuesta 3
            </button>
        </div>

        <!-- PROPUESTA COMPLETA: Timeline + Todo -->
        <div class="version-card">
            <div class="version-title">
                <span class="badge badge-version bg-danger">PROPUESTA COMPLETA</span>
                Todas las Mejoras Combinadas + Timeline Visual
            </div>
            <div class="alert alert-success">
                <i class="bi bi-star-fill me-2"></i>
                <strong>Incluye TODO:</strong> Vista previa, 2 columnas, validación RUT, timeline visual, estado calculado, gradientes
            </div>
            <button class="btn btn-danger btn-lg" data-bs-toggle="modal" data-bs-target="#modal-completo">
                <i class="bi bi-eye-fill me-2"></i>Ver Propuesta COMPLETA ⭐
            </button>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- MODAL ORIGINAL -->
    <!-- ========================================== -->
    <div class="modal fade" id="modal-original" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <form id="form-original" novalidate>
                    <div class="modal-header">
                        <h5 class="modal-title">Agregar/Editar Personal en Comisión</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" name="id">
                        <div class="row g-3">
                            <!-- SECCIÓN: DATOS PERSONALES -->
                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold">
                                    <i class="bi bi-person-fill me-2"></i>Datos Personales
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label for="rut-orig" class="form-label">RUT <span class="text-danger">*</span></label>
                                <input type="text" id="rut-orig" name="rut" class="form-control" placeholder="ej: 12345678" required>
                            </div>
                            <div class="col-md-6">
                                <label for="grado-orig" class="form-label">Grado</label>
                                <input type="text" id="grado-orig" name="grado" class="form-control" placeholder="ej: Capitán">
                            </div>
                            <div class="col-md-6">
                                <label for="nombres-orig" class="form-label">Nombres <span class="text-danger">*</span></label>
                                <input type="text" id="nombres-orig" name="nombres" class="form-control" required>
                            </div>
                            <div class="col-md-6">
                                <label for="paterno-orig" class="form-label">Apellido Paterno <span class="text-danger">*</span></label>
                                <input type="text" id="paterno-orig" name="paterno" class="form-control" required>
                            </div>
                            <div class="col-md-12">
                                <label for="materno-orig" class="form-label">Apellido Materno</label>
                                <input type="text" id="materno-orig" name="materno" class="form-control">
                            </div>

                            <!-- SECCIÓN: DATOS DE COMISIÓN -->
                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold mt-3">
                                    <i class="bi bi-briefcase-fill me-2"></i>Datos de Comisión
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label for="unidad_origen-orig" class="form-label">Unidad de Origen</label>
                                <input type="text" id="unidad_origen-orig" name="unidad_origen" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="fecha_inicio-orig" class="form-label">Inicio de Comisión</label>
                                <input type="date" id="fecha_inicio-orig" name="fecha_inicio" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="fecha_fin-orig" class="form-label">Fin de Comisión</label>
                                <input type="date" id="fecha_fin-orig" name="fecha_fin" class="form-control">
                            </div>
                            <div class="col-12">
                                <label for="motivo-orig" class="form-label">Motivo</label>
                                <textarea id="motivo-orig" name="motivo" class="form-control" rows="2"></textarea>
                            </div>

                            <!-- SECCIÓN: PUNTO DE CONTACTO -->
                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold mt-3">
                                    <i class="bi bi-person-badge-fill me-2"></i>Punto de Contacto (POC)
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label for="poc_nombre-orig" class="form-label">Nombre del POC</label>
                                <input type="text" id="poc_nombre-orig" name="poc_nombre" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="unidad_poc-orig" class="form-label">Unidad del POC</label>
                                <input type="text" id="unidad_poc-orig" name="unidad_poc" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="poc_anexo-orig" class="form-label">Anexo del POC</label>
                                <input type="text" id="poc_anexo-orig" name="poc_anexo" class="form-control">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- PROPUESTA 1: Header con Preview -->
    <!-- ========================================== -->
    <div class="modal fade" id="modal-propuesta1" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <form id="form-propuesta1" novalidate>
                    <div class="modal-header">
                        <h5 class="modal-title">Agregar/Editar Personal en Comisión</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    
                    <!-- NUEVO: Header con preview -->
                    <div class="modal-header bg-light border-top">
                        <div class="container-fluid">
                            <div class="row align-items-center">
                                <div class="col-md-7">
                                    <h6 class="mb-0 text-muted">
                                        <i class="bi bi-person-badge me-2"></i>
                                        <span id="preview-nombre-1" class="name-preview">Nuevo Registro</span>
                                    </h6>
                                </div>
                                <div class="col-md-5 text-end">
                                    <span class="badge bg-info" id="duracion-badge-1">
                                        <i class="bi bi-calendar-range me-1"></i>Duración: -- días
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-body">
                        <input type="hidden" name="id">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold">
                                    <i class="bi bi-person-fill me-2"></i>Datos Personales
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">RUT <span class="text-danger">*</span></label>
                                <input type="text" name="rut" class="form-control" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Grado</label>
                                <input type="text" name="grado" class="form-control" data-preview="1">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Nombres <span class="text-danger">*</span></label>
                                <input type="text" name="nombres" class="form-control" data-preview="1" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Apellido Paterno <span class="text-danger">*</span></label>
                                <input type="text" name="paterno" class="form-control" data-preview="1" required>
                            </div>
                            <div class="col-md-12">
                                <label class="form-label">Apellido Materno</label>
                                <input type="text" name="materno" class="form-control" data-preview="1">
                            </div>

                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold mt-3">
                                    <i class="bi bi-briefcase-fill me-2"></i>Datos de Comisión
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Unidad de Origen</label>
                                <input type="text" name="unidad_origen" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Inicio de Comisión</label>
                                <input type="date" name="fecha_inicio" class="form-control" data-fecha="1">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Fin de Comisión</label>
                                <input type="date" name="fecha_fin" class="form-control" data-fecha="1">
                            </div>
                            <div class="col-12">
                                <label class="form-label">Motivo</label>
                                <textarea name="motivo" class="form-control" rows="2"></textarea>
                            </div>

                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold mt-3">
                                    <i class="bi bi-person-badge-fill me-2"></i>Punto de Contacto (POC)
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Nombre del POC</label>
                                <input type="text" name="poc_nombre" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Unidad del POC</label>
                                <input type="text" name="unidad_poc" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Anexo del POC</label>
                                <input type="text" name="poc_anexo" class="form-control">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer bg-light">
                        <div class="me-auto text-muted small">
                            <i class="bi bi-info-circle me-1"></i>
                            Los campos marcados con <span class="text-danger">*</span> son obligatorios
                        </div>
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-circle me-1"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save me-1"></i>Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- PROPUESTA 2: Layout 2 Columnas -->
    <!-- ========================================== -->
    <div class="modal fade" id="modal-propuesta2" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <form id="form-propuesta2" novalidate>
                    <div class="modal-header">
                        <h5 class="modal-title">Agregar/Editar Personal en Comisión</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" name="id">
                        <div class="row g-4">
                            
                            <!-- COLUMNA IZQUIERDA: Datos Personales -->
                            <div class="col-lg-6">
                                <div class="card border-primary shadow-sm h-100">
                                    <div class="card-header bg-primary text-white">
                                        <i class="bi bi-person-fill me-2"></i>Datos Personales
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12">
                                                <label class="form-label">RUT <span class="text-danger">*</span></label>
                                                <input type="text" name="rut" class="form-control" required>
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Grado</label>
                                                <input type="text" name="grado" class="form-control">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Nombres <span class="text-danger">*</span></label>
                                                <input type="text" name="nombres" class="form-control" required>
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Apellido Paterno <span class="text-danger">*</span></label>
                                                <input type="text" name="paterno" class="form-control" required>
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Apellido Materno</label>
                                                <input type="text" name="materno" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- COLUMNA DERECHA: Comisión + POC -->
                            <div class="col-lg-6">
                                <!-- Card de Comisión -->
                                <div class="card border-success shadow-sm mb-3">
                                    <div class="card-header bg-success text-white">
                                        <i class="bi bi-briefcase-fill me-2"></i>Datos de Comisión
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12">
                                                <label class="form-label">Unidad de Origen</label>
                                                <input type="text" name="unidad_origen" class="form-control">
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label">Fecha Inicio</label>
                                                <input type="date" name="fecha_inicio" class="form-control">
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label">Fecha Fin</label>
                                                <input type="date" name="fecha_fin" class="form-control">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Motivo</label>
                                                <textarea name="motivo" class="form-control" rows="2"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card de POC -->
                                <div class="card border-info shadow-sm">
                                    <div class="card-header bg-info text-white">
                                        <i class="bi bi-person-badge-fill me-2"></i>Punto de Contacto
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12">
                                                <label class="form-label">Nombre POC</label>
                                                <input type="text" name="poc_nombre" class="form-control">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Unidad POC</label>
                                                <input type="text" name="unidad_poc" class="form-control">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label">Anexo POC</label>
                                                <input type="text" name="poc_anexo" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- PROPUESTA 3: Validación RUT -->
    <!-- ========================================== -->
    <div class="modal fade" id="modal-propuesta3" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <form id="form-propuesta3" novalidate>
                    <div class="modal-header">
                        <h5 class="modal-title">Agregar/Editar Personal en Comisión</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" name="id">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold">
                                    <i class="bi bi-person-fill me-2"></i>Datos Personales
                                </h6>
                            </div>
                            
                            <!-- RUT con Validación Visual -->
                            <div class="col-md-6">
                                <label class="form-label">RUT <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-card-text"></i></span>
                                    <input type="text" 
                                           id="rut-validado" 
                                           name="rut" 
                                           class="form-control" 
                                           placeholder="12.345.678-9" 
                                           required
                                           maxlength="12">
                                    <span class="input-group-text" id="rut-icon">
                                        <i class="bi bi-question-circle text-muted"></i>
                                    </span>
                                </div>
                                <div class="invalid-feedback">RUT inválido</div>
                                <div class="valid-feedback">✓ RUT válido</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label class="form-label">Grado</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-award"></i></span>
                                    <input type="text" name="grado" class="form-control">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Nombres <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                                    <input type="text" name="nombres" class="form-control" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Apellido Paterno <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-person-badge"></i></span>
                                    <input type="text" name="paterno" class="form-control" required>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label class="form-label">Apellido Materno</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-person-badge"></i></span>
                                    <input type="text" name="materno" class="form-control">
                                </div>
                            </div>

                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold mt-3">
                                    <i class="bi bi-briefcase-fill me-2"></i>Datos de Comisión
                                </h6>
                            </div>
                            <div class="col-md-12">
                                <label class="form-label">Unidad de Origen</label>
                                <input type="text" name="unidad_origen" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Fecha Inicio</label>
                                <input type="date" name="fecha_inicio" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Fecha Fin</label>
                                <input type="date" name="fecha_fin" class="form-control">
                            </div>
                            <div class="col-12">
                                <label class="form-label">Motivo</label>
                                <textarea name="motivo" class="form-control" rows="2"></textarea>
                            </div>

                            <div class="col-12">
                                <h6 class="border-bottom pb-2 mb-3 text-primary fw-bold mt-3">
                                    <i class="bi bi-person-badge-fill me-2"></i>Punto de Contacto (POC)
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Nombre POC</label>
                                <input type="text" name="poc_nombre" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Unidad POC</label>
                                <input type="text" name="unidad_poc" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Anexo POC</label>
                                <input type="text" name="poc_anexo" class="form-control">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- MODAL COMPLETO: Todas las mejoras -->
    <!-- ========================================== -->
    <div class="modal fade" id="modal-completo" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <form id="form-completo" novalidate>
                    <div class="modal-header gradient-card-header">
                        <h5 class="modal-title">
                            <i class="bi bi-star-fill me-2"></i>
                            Personal en Comisión
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    
                    <!-- Header con preview mejorado -->
                    <div class="modal-header bg-light border-top">
                        <div class="container-fluid">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <h6 class="mb-0">
                                        <i class="bi bi-person-badge text-primary me-2"></i>
                                        <span id="preview-nombre-completo" class="name-preview fw-bold">Nuevo Registro</span>
                                    </h6>
                                </div>
                                <div class="col-md-4 text-end">
                                    <span class="badge bg-gradient bg-info text-white" id="duracion-badge-completo">
                                        <i class="bi bi-calendar-range me-1"></i>Duración: -- días
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-body">
                        <input type="hidden" name="id">
                        <div class="row g-4">
                            
                            <!-- COLUMNA IZQUIERDA -->
                            <div class="col-lg-6">
                                <div class="card shadow-sm h-100" style="border-left: 4px solid #667eea;">
                                    <div class="card-header gradient-card-header">
                                        <i class="bi bi-person-fill me-2"></i>Datos Personales
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <!-- RUT con Validación -->
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-card-text me-1"></i>
                                                    RUT <span class="text-danger">*</span>
                                                </label>
                                                <div class="input-group">
                                                    <span class="input-group-text bg-light">
                                                        <i class="bi bi-shield-check"></i>
                                                    </span>
                                                    <input type="text" 
                                                           id="rut-completo" 
                                                           name="rut" 
                                                           class="form-control" 
                                                           placeholder="12.345.678-9" 
                                                           required
                                                           maxlength="12">
                                                    <span class="input-group-text" id="rut-icon-completo">
                                                        <i class="bi bi-question-circle text-muted"></i>
                                                    </span>
                                                </div>
                                                <div class="invalid-feedback">RUT inválido</div>
                                                <div class="valid-feedback">✓ RUT válido</div>
                                            </div>
                                            
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-award me-1"></i>Grado
                                                </label>
                                                <input type="text" name="grado" class="form-control" data-preview-completo="1" placeholder="Ej: Capitán, Mayor">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-person me-1"></i>
                                                    Nombres <span class="text-danger">*</span>
                                                </label>
                                                <input type="text" name="nombres" class="form-control" data-preview-completo="1" required>
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-person-badge me-1"></i>
                                                    Apellido Paterno <span class="text-danger">*</span>
                                                </label>
                                                <input type="text" name="paterno" class="form-control" data-preview-completo="1" required>
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-person-badge me-1"></i>
                                                    Apellido Materno
                                                </label>
                                                <input type="text" name="materno" class="form-control" data-preview-completo="1">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- COLUMNA DERECHA -->
                            <div class="col-lg-6">
                                <!-- Card de Comisión con gradiente -->
                                <div class="card shadow-sm mb-3" style="border-left: 4px solid #38ef7d;">
                                    <div class="card-header gradient-success text-white">
                                        <i class="bi bi-briefcase-fill me-2"></i>Datos de Comisión
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-building me-1"></i>
                                                    Unidad de Origen
                                                </label>
                                                <input type="text" name="unidad_origen" class="form-control">
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-calendar-check me-1"></i>
                                                    Fecha Inicio
                                                </label>
                                                <input type="date" name="fecha_inicio" class="form-control" data-fecha-completo="1">
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-calendar-x me-1"></i>
                                                    Fecha Fin
                                                </label>
                                                <input type="date" name="fecha_fin" class="form-control" data-fecha-completo="1">
                                            </div>
                                            
                                            <!-- Estado Calculado -->
                                            <div class="col-12">
                                                <div class="alert alert-info mb-0 py-2" role="alert" id="estado-alert-completo">
                                                    <i class="bi bi-info-circle me-2"></i>
                                                    <span id="estado-text-completo">
                                                        Se calculará automáticamente según fecha fin
                                                    </span>
                                                </div>
                                            </div>
                                            
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-chat-left-text me-1"></i>
                                                    Motivo
                                                </label>
                                                <textarea name="motivo" class="form-control" rows="2" placeholder="Describe el motivo de la comisión..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card de POC con gradiente -->
                                <div class="card shadow-sm" style="border-left: 4px solid #00f2fe;">
                                    <div class="card-header gradient-info text-white">
                                        <i class="bi bi-person-badge-fill me-2"></i>Punto de Contacto (POC)
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-person-circle me-1"></i>
                                                    Nombre POC
                                                </label>
                                                <input type="text" name="poc_nombre" class="form-control">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-building me-1"></i>
                                                    Unidad POC
                                                </label>
                                                <input type="text" name="unidad_poc" class="form-control">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label fw-bold">
                                                    <i class="bi bi-telephone me-1"></i>
                                                    Anexo POC
                                                </label>
                                                <input type="text" name="poc_anexo" class="form-control" placeholder="Ej: 5555">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- TIMELINE VISUAL (ocupa todo el ancho) -->
                            <div class="col-12">
                                <div class="card border-0 shadow-sm" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                                    <div class="card-body">
                                        <h6 class="text-dark mb-4">
                                            <i class="bi bi-graph-up me-2"></i>Línea de Tiempo de la Comisión
                                        </h6>
                                        
                                        <div class="timeline-container">
                                            <div class="timeline-line"></div>
                                            
                                            <!-- Marcador Inicio -->
                                            <div class="timeline-marker" style="left: 40px;">
                                                <div class="timeline-dot bg-success text-white">
                                                    <i class="bi bi-play-fill"></i>
                                                </div>
                                                <small class="fw-bold" id="timeline-inicio-completo">Inicio</small>
                                            </div>
                                            
                                            <!-- Marcador Hoy -->
                                            <div class="timeline-marker" id="timeline-hoy-completo" style="left: 50%; display: none;">
                                                <div class="timeline-dot bg-primary text-white" style="width: 50px; height: 50px; font-size: 1.2rem;">
                                                    <i class="bi bi-calendar-check"></i>
                                                </div>
                                                <small class="fw-bold text-primary">HOY</small>
                                            </div>
                                            
                                            <!-- Marcador Fin -->
                                            <div class="timeline-marker" style="right: 40px; left: auto;">
                                                <div class="timeline-dot bg-danger text-white">
                                                    <i class="bi bi-stop-fill"></i>
                                                </div>
                                                <small class="fw-bold" id="timeline-fin-completo">Fin</small>
                                            </div>
                                        </div>
                                        
                                        <!-- Estadísticas -->
                                        <div class="row mt-4 text-center">
                                            <div class="col-4">
                                                <div class="bg-white rounded p-2 shadow-sm">
                                                    <small class="text-muted d-block">Días transcurridos</small>
                                                    <div class="fw-bold text-success" id="dias-transcurridos-completo">--</div>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="bg-white rounded p-2 shadow-sm">
                                                    <small class="text-muted d-block">Duración total</small>
                                                    <div class="fw-bold text-primary" id="duracion-total-completo">--</div>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="bg-white rounded p-2 shadow-sm">
                                                    <small class="text-muted d-block">Días restantes</small>
                                                    <div class="fw-bold text-warning" id="dias-restantes-completo">--</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="modal-footer bg-light">
                        <div class="me-auto text-muted">
                            <i class="bi bi-info-circle me-1"></i>
                            <small>Los campos marcados con <span class="text-danger">*</span> son obligatorios</small>
                        </div>
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-circle me-1"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save me-1"></i>Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ========================================
        // PROPUESTA 1: Preview del nombre
        // ========================================
        document.getElementById('form-propuesta1')?.addEventListener('input', (e) => {
            if (e.target.dataset.preview === '1') {
                const form = e.target.closest('form');
                const grado = form.querySelector('[name="grado"]').value || '';
                const nombres = form.querySelector('[name="nombres"]').value || '';
                const paterno = form.querySelector('[name="paterno"]').value || '';
                const materno = form.querySelector('[name="materno"]').value || '';
                
                const nombreCompleto = `${grado} ${nombres} ${paterno} ${materno}`.trim() || 'Nuevo Registro';
                const previewEl = document.getElementById('preview-nombre-1');
                previewEl.textContent = nombreCompleto;
                previewEl.classList.add('updated');
                setTimeout(() => previewEl.classList.remove('updated'), 500);
            }
            
            if (e.target.dataset.fecha === '1') {
                calcularDuracion('form-propuesta1', 'duracion-badge-1');
            }
        });

        // ========================================
        // PROPUESTA 3: Validación de RUT
        // ========================================
        document.getElementById('rut-validado')?.addEventListener('input', function(e) {
            const input = e.target;
            let value = input.value.replace(/[^0-9kK]/g, '');
            
            // Formatear
            if (value.length > 1) {
                const dv = value.slice(-1);
                const numero = value.slice(0, -1);
                value = numero.replace(/\B(?=(\d{3})+(?!\d))/g, '.') + '-' + dv;
            }
            input.value = value;
            
            // Validar (simple para demo)
            const icon = document.getElementById('rut-icon');
            if (value.length >= 11) {
                input.classList.remove('is-invalid');
                input.classList.add('is-valid');
                icon.innerHTML = '<i class="bi bi-check-circle-fill text-success"></i>';
            } else if (value.length > 0) {
                input.classList.remove('is-valid');
                input.classList.add('is-invalid');
                icon.innerHTML = '<i class="bi bi-x-circle-fill text-danger"></i>';
            } else {
                input.classList.remove('is-valid', 'is-invalid');
                icon.innerHTML = '<i class="bi bi-question-circle text-muted"></i>';
            }
        });

        // ========================================
        // MODAL COMPLETO: Todas las funciones
        // ========================================
        
        // Preview del nombre
        document.getElementById('form-completo')?.addEventListener('input', (e) => {
            if (e.target.dataset.previewCompleto === '1') {
                const form = e.target.closest('form');
                const grado = form.querySelector('[name="grado"]').value || '';
                const nombres = form.querySelector('[name="nombres"]').value || '';
                const paterno = form.querySelector('[name="paterno"]').value || '';
                const materno = form.querySelector('[name="materno"]').value || '';
                
                const nombreCompleto = `${grado} ${nombres} ${paterno} ${materno}`.trim() || 'Nuevo Registro';
                const previewEl = document.getElementById('preview-nombre-completo');
                previewEl.textContent = nombreCompleto;
                previewEl.classList.add('updated');
                setTimeout(() => previewEl.classList.remove('updated'), 500);
            }
            
            if (e.target.dataset.fechaCompleto === '1') {
                calcularDuracionCompleta();
            }
        });

        // Validación RUT en modal completo
        document.getElementById('rut-completo')?.addEventListener('input', function(e) {
            const input = e.target;
            let value = input.value.replace(/[^0-9kK]/g, '');
            
            if (value.length > 1) {
                const dv = value.slice(-1);
                const numero = value.slice(0, -1);
                value = numero.replace(/\B(?=(\d{3})+(?!\d))/g, '.') + '-' + dv;
            }
            input.value = value;
            
            const icon = document.getElementById('rut-icon-completo');
            if (value.length >= 11) {
                input.classList.remove('is-invalid');
                input.classList.add('is-valid');
                icon.innerHTML = '<i class="bi bi-check-circle-fill text-success"></i>';
            } else if (value.length > 0) {
                input.classList.remove('is-valid');
                input.classList.add('is-invalid');
                icon.innerHTML = '<i class="bi bi-x-circle-fill text-danger"></i>';
            } else {
                input.classList.remove('is-valid', 'is-invalid');
                icon.innerHTML = '<i class="bi bi-question-circle text-muted"></i>';
            }
        });

        // Función auxiliar para calcular duración
        function calcularDuracion(formId, badgeId) {
            const form = document.getElementById(formId);
            const inicio = form.querySelector('[name="fecha_inicio"]').value;
            const fin = form.querySelector('[name="fecha_fin"]').value;
            const badge = document.getElementById(badgeId);
            
            if (inicio && fin) {
                const fechaInicio = new Date(inicio);
                const fechaFin = new Date(fin);
                const diferencia = Math.ceil((fechaFin - fechaInicio) / (1000 * 60 * 60 * 24));
                
                if (diferencia >= 0) {
                    badge.innerHTML = `<i class="bi bi-calendar-range me-1"></i>Duración: ${diferencia} días`;
                    badge.className = 'badge bg-success';
                } else {
                    badge.innerHTML = `<i class="bi bi-exclamation-triangle me-1"></i>Fecha fin menor a inicio`;
                    badge.className = 'badge bg-danger';
                }
            } else {
                badge.innerHTML = `<i class="bi bi-calendar-range me-1"></i>Duración: -- días`;
                badge.className = 'badge bg-info';
            }
        }

        // Función completa con timeline
        function calcularDuracionCompleta() {
            const form = document.getElementById('form-completo');
            const inicio = form.querySelector('[name="fecha_inicio"]').value;
            const fin = form.querySelector('[name="fecha_fin"]').value;
            
            if (inicio && fin) {
                const fechaInicio = new Date(inicio);
                const fechaFin = new Date(fin);
                const hoy = new Date();
                hoy.setHours(0, 0, 0, 0);
                
                const duracionTotal = Math.ceil((fechaFin - fechaInicio) / (1000 * 60 * 60 * 24));
                const diasTranscurridos = Math.max(0, Math.ceil((hoy - fechaInicio) / (1000 * 60 * 60 * 24)));
                const diasRestantes = Math.max(0, Math.ceil((fechaFin - hoy) / (1000 * 60 * 60 * 24)));
                
                // Actualizar badge
                const badge = document.getElementById('duracion-badge-completo');
                badge.innerHTML = `<i class="bi bi-calendar-range me-1"></i>Duración: ${duracionTotal} días`;
                badge.className = duracionTotal >= 0 ? 'badge bg-success' : 'badge bg-danger';
                
                // Actualizar estado
                const estadoAlert = document.getElementById('estado-alert-completo');
                const estadoText = document.getElementById('estado-text-completo');
                
                if (fechaFin >= hoy) {
                    estadoAlert.className = 'alert alert-success mb-0 py-2';
                    estadoText.innerHTML = '<i class="bi bi-check-circle-fill me-2"></i>Estado: <strong>ACTIVO</strong>';
                } else {
                    estadoAlert.className = 'alert alert-danger mb-0 py-2';
                    estadoText.innerHTML = '<i class="bi bi-x-circle-fill me-2"></i>Estado: <strong>FINALIZADO</strong>';
                }
                
                // Actualizar timeline
                document.getElementById('timeline-inicio-completo').textContent = fechaInicio.toLocaleDateString('es-CL');
                document.getElementById('timeline-fin-completo').textContent = fechaFin.toLocaleDateString('es-CL');
                
                // Mostrar marcador HOY si está en el rango
                const markerHoy = document.getElementById('timeline-hoy-completo');
                if (hoy >= fechaInicio && hoy <= fechaFin) {
                    const porcentaje = ((hoy - fechaInicio) / (fechaFin - fechaInicio)) * 100;
                    markerHoy.style.left = `calc(40px + ${porcentaje}% * (100% - 80px) / 100%)`;
                    markerHoy.style.display = 'block';
                } else {
                    markerHoy.style.display = 'none';
                }
                
                // Actualizar estadísticas
                document.getElementById('dias-transcurridos-completo').textContent = diasTranscurridos;
                document.getElementById('duracion-total-completo').textContent = duracionTotal;
                document.getElementById('dias-restantes-completo').textContent = diasRestantes;
            }
        }

        // Prevenir submit de formularios (solo demo)
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('✅ Formulario validado correctamente!\n\nEn producción, aquí se enviarían los datos al servidor.');
            });
        });
    </script>
</body>
</html>
